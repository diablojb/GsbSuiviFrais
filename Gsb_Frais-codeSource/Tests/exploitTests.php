<?php
Require("../include/_bdGestionDonnees.lib.php");
/**
 * Classe pour l'ensembles des tests
 *
 * @author jb
 */
class exploitTests extends \PHPUnit_Framework_TestCase{
    
    /**
     * test la connexion a la base de données
     * 
     * 
     */
    public function testCoDb(){        
        $this->assertTrue(connecterServeurBD() != false);
    }
    
    /**
     * test de la fonction d'update des fiches
     * 
     */
    public function testUpdateFicheFrais(){
        $idconnexion = connecterServeurBD();
        $unEtat = 'VA';//id de la validation des fiches
        $unIdVisiteur = 'a17';//un id de visiteur médical
        $unMois = 201301;//la fiche du mois de javanier
         $requete = "UPDATE FicheFrais SET idEtat = '" . $unEtat . 
               "', dateModif = now() WHERE idVisiteur ='" .
               $unIdVisiteur . "' AND mois = '". $unMois . "'";
        $nbr = mysql_query($requete, $idconnexion);//le nbr de lignes affectées
        $this->isTrue($nbr > 0);
    }
    
    /**
     * 
     */
    public function testDernierMoisSaisie(){
        $idconnexion = connecterServeurBD();
        $unIdVisiteur = 'a17';
        $unMois = obtenirDernierMoisSaisi($idconnexion, $unIdVisiteur);
        $this->isTrue($unMois != null && $unMois != " ");//valide si les conditions sont remplie 
    }
}

?>
